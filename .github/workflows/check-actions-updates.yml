name: Check-Actions-Updates

on:
  push:
    branches:
      - main
  pull_request:
  workflow_dispatch:
  schedule:
    - cron: '0 16 * * 2' # Runs Tuesdays at 16:00 UTC

permissions:
  contents: read

jobs:
  check-actions:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6.0.1
      - id: actions-check
        run: ${{ github.workspace }}/.github/scripts/check-actions-updates.sh
      - if: steps.actions-check.outputs.has-updates == 'true'
        run: |
          echo "::error:: Found ${{ steps.actions-check.outputs.update-count }} outdated GitHub Actions. Please update them before merging."
          echo "You can update them by running: npx actions-up"
          echo "Or manually update the versions in your workflows."
          exit 1

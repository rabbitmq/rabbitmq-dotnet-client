<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2003/01/wi">
    <Module Id='DotNetClientModule' Guid='97DB49A3-B75E-4AE1-B01A-DFC8E335F866' Language='1033' Codepage='1252' Version='@VERSION@'>
        <Package Id='????????-????-????-????-????????????' Description='RabbitMQ .NET Client @VERSION@' Manufacturer='GoPivotal, Inc.'
                 InstallerVersion='150' Languages='1033' Compressed='yes' SummaryCodepage='1252' />
        <!-- VERSION is the RabbitMQ release version. This might differ
             from the RabbitMQ.Client.dll version (which always has 4
             components). -->

        <Directory Id='TARGETDIR' Name='SourceDir'>
            <!-- Note that RabbitMQ.Client.dll has to appear twice
                 (once for having it copied to Windows\assembly and once for
                 having it in our own bin folder).
                 This is a bug in WiX 2.0 and will be fixed in WiX 3.0
                 (i.e. will only have to be specified once, with Assembly='.net'
                 in order to be copied in both places). -->
            <Component Id='ClientLibraryAssembly' Guid='06543EE8-DED2-4C1C-826E-6AAE0B403AF3'>
                <File Id='RabbitMQClientDllAssembly' Name='RMQClnt.dll' LongName='RabbitMQ.Client.dll' Vital='yes' Assembly='.net' KeyPath='yes'
                      Source='..\tmp\unzip\rabbitmq-dotnet-client-@VERSION@\bin\RabbitMQ.Client.dll' />
            </Component>

            <Directory Id='BinFolder' Name='bin'>
                <Component Id='ClientLibraryBin' Guid='83A1DE00-CCB6-42C2-BD14-FBAEDDBC50E8'>
                    <CreateFolder />
                    <File Id='RabbitMQClientDllBin' Name='RMQClnt.dll' LongName='RabbitMQ.Client.dll' Vital='yes' KeyPath='yes'
                          Source='..\tmp\unzip\rabbitmq-dotnet-client-@VERSION@\bin\RabbitMQ.Client.dll' />
                    <File Id='RabbitMQClientDllXml' Name='RMQClnt.xml' LongName='RabbitMQ.Client.xml' Vital='yes'
                          Source='..\tmp\unzip\rabbitmq-dotnet-client-@VERSION@\bin\RabbitMQ.Client.xml' />
                    <Registry Id='RabbitMQAssemblyFolderReg' Action='createKeyAndRemoveKeyOnUninstall'
                              Key='SOFTWARE\Microsoft\.NETFramework\AssemblyFolders\RabbitMQ' Root='HKLM'>
                        <Registry Id='RabbitMQAssemblyFolderRegVal' Action='write' Type='string' Value='[BinFolder]' />
                    </Registry>
                </Component>
            </Directory>

            <Directory Id='ExamplesFolder' Name='examples'>
                <Directory Id='BinExamplesFolder' Name='bin'>
                    <Component Id='ExampleBinaries' Guid='1C270D1C-CD79-49D8-9413-E6211F52B5A8'>
@FILES ../tmp/unzip/rabbitmq-dotnet-client-@VERSION@/bin -name *.exe
                    </Component>
                </Directory>
                
                <Directory Id='SrcExamplesFolder' Name='src'>
                    <Component Id='ExampleSources' Guid='962896C3-D476-4C8E-B5F3-BE963D566A49'>
@FILES ../tmp/unzip/rabbitmq-dotnet-client-@VERSION@/projects/examples/client -name *.cs -not -name AssemblyInfo.cs
                    </Component>
                </Directory>
                
                <Component Id='ExamplesShortcut' Guid='19A73961-DFC6-47BC-AC46-77B7562D7B91'>
                    <CreateFolder>
                        <Shortcut Id='ExamplesShortcut' Directory='DOTNET_CLIENT_MENU_DIR' Name='Examples' LongName='Examples folder' />
                    </CreateFolder>
                </Component>
            </Directory>

            <Directory Id='DocFolder' Name='doc'>
                <Directory Id='HtmlFolder' Name='html'>
                    <Component Id='HtmlApiDocumentation' Guid='7B03679B-9677-4679-AE2B-1F70E7D92B45'>
@FILES ../tmp/unzip/rabbitmq-dotnet-client-@VERSION@-client-htmldoc/html ( -name *.html -o -name *.css )
                        <Shortcut Id='HtmlApiDocShortcut' Target="[#indexhtml]" Directory='DOTNET_CLIENT_MENU_DIR' Name='HtmlDoc' LongName='Autogenerated API documentation (HTML)' />
                    </Component>
                </Directory>
                
                <Directory Id='PdfFolder' Name='pdf' FileSource='..\tmp\unzip\'>
                    <Component Id='PdfApiDocumentation' Guid='018D0FDF-9B7F-4C44-9072-A1030336B076'>
                        <File Id='ApiGuidePdf' Name='apiguide.pdf' LongName='rabbitmq-dotnet-client-@VERSION@-api-guide.pdf' Vital='yes'>
                            <Shortcut Id='PdfApiDocShortcut' Directory='DOTNET_CLIENT_MENU_DIR' Name='ApiPdf' LongName='Autogenerated API documentation (PDF)' />
                        </File>
                    </Component>

                    <Component Id='UserGuide' Guid='A463E3B7-5E2F-4628-9019-6BA1A3277520'>
                        <File Id='UserGuidePdf' Name='usrguide.pdf' LongName='rabbitmq-dotnet-client-@VERSION@-user-guide.pdf' Vital='yes'>
                            <Shortcut Id='UserGuidePdfShortcut' Directory='DOTNET_CLIENT_MENU_DIR' Name='UsrGdPdf' LongName='User guide (PDF)' />
                        </File>
                    </Component>
                </Directory>
            </Directory>

            <Directory Id='ProgramMenuFolder' Name='PMenu'>
                <Directory Id='RabbitMQMenuFolder' Name='RabbitMQ'>
                    <Directory Id='DOTNET_CLIENT_MENU_DIR' Name='DNClient' LongName='DotNetClient' />
                </Directory>
            </Directory>
        </Directory>
    </Module>
</Wix>
